{% extends "base.html" %}
{% block content %}
    <div class="card mb-4 border-0 shadow-sm">
        <div class="card-body">
            <img class="rounded-circle mr-2 shadow-sm" style="width: 50px; height: 50px; object-fit: cover;" src="{{ url_for('static', filename='profile_pics/' + topic.author.image_file) }}">
            <h2 class="d-inline h4 text-primary align-middle ml-2">{{ topic.title }}</h2>

            <a href="{{ url_for('home', category=topic.category) }}">
            <span class="badge badge-pill badge-secondary ml-2 align-middle">{{ topic.category }}</span>
            </a>
            <span class="badge badge-pill 
            {% if topic.category == 'General' %}badge-secondary
            {% elif topic.category == 'Brainwave' %}badge-success
            {% elif topic.category == 'Help' %}badge-danger
            {% else %}badge-info
            {% endif %} ml-2 align-middle">
            {{ topic.category }}
            </span>
            <p class="text-muted small">
                By <a href="{{ url_for('user_posts', username=topic.author.username) }}"><strong>{{ topic.author.username }}</strong></a> 
                on {{ topic.date_posted.strftime('%B %d, %Y at %H:%M') }}
            </p>
            <p class="mt-4 lead">{{ topic.content }}</p>
            {% if topic.author == current_user %}
                <form action="{{ url_for('delete_post', post_id=topic.id) }}" method="POST" class="mt-3 border-top pt-2">
                    <input class="btn btn-danger btn-sm" type="submit" value="Delete Topic" onclick="return confirm('Really delete?');">
                </form>
            {% endif %}
        </div>
    </div>
    <h5 class="mb-3 text-muted">Replies</h5>
{% for reply in replies %}
    <div class="media mb-3 p-3 bg-white border-left border-primary rounded shadow-xs ml-5">
        <div class="media-body">
            <strong>{{ reply.author.username }}</strong> 
            <small class="text-muted ml-2">{{ reply.date_posted.strftime('%b %d, %Y') }}</small>
            <p class="mb-0 mt-2">{{ reply.content }}</p>
        </div>
    </div>
{% endfor %}    
{% if current_user.is_authenticated %}
    <form method="POST" class="mt-5 p-3 border rounded bg-white">
        {{ form.hidden_tag() }}
        <div class="form-group">{{ form.content(class="form-control", placeholder="Write a reply...") }}</div>
        {{ form.submit(class="btn btn-primary") }}
    </form>
    {% endif %}
{% endblock %}