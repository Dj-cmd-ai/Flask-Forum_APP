{% extends "base.html" %}
{% block content %}
    <h1 class="mb-4 font-weight-bold" style="color: #2c3e50;">Discussion Board</h1>
    
    {% for post in topics.items %}
        <article class="content-section">
            <div class="d-flex align-items-center mb-3">
                <img class="account-img shadow-sm" 
                    src="{{ url_for('static', filename='profile_pics/' + post.author.image_file) }}" 
                    onerror="this.style.display='none'"
                alt="">
                
                <div>
                    <a class="mr-2 font-weight-bold" href="{{ url_for('user_posts', username=post.author.username) }}" style="color: #007bff;">
                        {{ post.author.username }}
                    </a>
                    <small class="text-muted">{{ post.date_posted.strftime('%B %d, %Y') }}</small>
                    
                    {% if post.category == 'Brainwave' %}
                        <span class="badge badge-pill badge-success ml-2">Brainwave</span>
                    {% elif post.category == 'Help' %}
                        <span class="badge badge-pill badge-danger ml-2">Help</span>
                    {% else %}
                        <span class="badge badge-pill badge-secondary ml-2">General</span>
                    {% endif %}
                </div>
            </div>

            <h2><a class="article-title" href="{{ url_for('view_topic', topic_id=post.id) }}">{{ post.title }}</a></h2>
            <p class="article-content text-secondary">{{ post.content[:200] }}{% if post.content|length > 200 %}...{% endif %}</p>
            
            <div class="border-top pt-2 mt-3">
                <a href="{{ url_for('view_topic', topic_id=post.id) }}" class="btn btn-outline-primary btn-sm">View Discussion</a>
            </div>
        </article>
    {% endfor %}

    <nav aria-label="Page navigation">
      <ul class="pagination justify-content-center">
        {% for page_num in topics.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}
          {% if page_num %}
            {% if topics.page == page_num %}
              <li class="page-item active"><a class="page-link" href="{{ url_for('home', page=page_num, category=category_filter, search=search_term) }}">{{ page_num }}</a></li>
            {% else %}
              <li class="page-item"><a class="page-link" href="{{ url_for('home', page=page_num, category=category_filter, search=search_term) }}">{{ page_num }}</a></li>
            {% endif %}
          {% else %}
            <li class="page-item disabled"><span class="page-link">...</span></li>
          {% endif %}
        {% endfor %}
      </ul>
    </nav>
{% endblock %}